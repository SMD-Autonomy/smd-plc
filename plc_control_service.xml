<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://community.rti.com/schema/7.3.0/rti_dds_opcua_service.xsd">
  <types>
        <struct name="Power" nested="true">
            <member name="CMD" type="boolean"/>
            <member name="On" type="boolean"/>
        </struct>
  
        <struct name="LampControlType" nested="true">
            <member name="intensity" type="float32"/>
            <member name="power" type="nonBasic" nonBasicTypeName="Power"/>
        </struct>

        <struct name="CameraControlType" nested="true">
            <member name="focus_far" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="focus_near" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="LED" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="power" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="zoom_in" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="zoom_out" type="nonBasic" nonBasicTypeName="Power"/>
        </struct>

        <struct name="PanAndTiltControlType" nested="true">
            <member name="pan_left" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="pan_right" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="power" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="tilt_down" type="nonBasic" nonBasicTypeName="Power"/>
            <member name="tilt_up" type="nonBasic" nonBasicTypeName="Power"/>
        </struct>
  </types>

  <ddsopcua_service name="PLCcontrolService">

    <opcua_connection name="PLCServerConnection" server_endpoint_url="opc.tcp://192.168.1.1:4840">
      <timeout>5000</timeout>
    </opcua_connection>

    <domain_participant name="PLCDomainParticipant" domain_id="6">
      <register_type name="CameraControl" type_ref="CameraControlType"/>  
      <register_type name="LampControl" type_ref="LampControlType"/>   
      <register_type name="PanAndTiltControl" type_ref="PanAndTiltControlType"/>
    </domain_participant>

    <opcua_to_dds_bridge name="PLCControlBridge">
      <service_set opcua_connection_ref="PLCServerConnection" domain_participant_ref="PLCDomainParticipant">

        <!-- Enable the Attribute Service Set that allows remote applications to perform Read/Write operations through the OPC UA/DDS Gateway. -->
        <attribute_service_set>
          <enabled>false</enabled>
        </attribute_service_set>
      </service_set>

      <publication name="CameraControlPublication">
        <dds_input name="PLCDDSInput" domain_participant_ref="PLCDomainParticipant">
          <topic_name>CameraControlTopic</topic_name>
          <registered_type_name>CameraControl</registered_type_name>
        </dds_input>

        <opcua_output name="PLCOPCOutput" opcua_connection_ref="PLCServerConnection">
           <node_attribute dds_topic_field_name="LED.CMD">
              <node_id>
                <namespace_index>6</namespace_index>
                <string_identifier>Root.Objects.00, 1756-L85E/B, OPCUA_QA67231.Adv_Control.Adv_Control[2].ROV.IO_Camera_Control.IO_Camera_Control[2].LED.CMD</string_identifier>
              </node_id>
              <attribute_id>VALUE</attribute_id>
            </node_attribute>
        </opcua_output>
      </publication>

      <publication name="LampControlPublication">
        <dds_input name="PLCDDSInput" domain_participant_ref="PLCDomainParticipant">
          <topic_name>LampControlTopic</topic_name>
          <registered_type_name>LampControl</registered_type_name>
        </dds_input>

        <opcua_output name="PLCOPCOutput" opcua_connection_ref="PLCServerConnection">
           <node_attribute dds_topic_field_name="power.CMD">
              <node_id>
                <namespace_index>6</namespace_index>
                <string_identifier>Root.Objects.00, 1756-L85E/B, OPCUA_QA67231.Adv_Control.Adv_Control[2].ROV.IO_Lamp_Control.IO_Lamp_Control[2].Power.CMD</string_identifier>
              </node_id>
              <attribute_id>VALUE</attribute_id>
            </node_attribute>
        </opcua_output>
      </publication>

      <publication name="PanAndTiltControlPublication">
        <dds_input name="PLCDDSInput" domain_participant_ref="PLCDomainParticipant">
          <topic_name>PanAndTiltControlTopic</topic_name>
          <registered_type_name>PanAndTiltControl</registered_type_name>
        </dds_input>

        <opcua_output name="PLCOPCOutput" opcua_connection_ref="PLCServerConnection">
           <node_attribute dds_topic_field_name="power.CMD">
              <node_id>
                <namespace_index>6</namespace_index>
                <string_identifier>Root.Objects.00, 1756-L85E/B, OPCUA_QA67231.Adv_Control.Adv_Control[2].ROV.IO_PanTilt_Control.IO_PanTilt_Control[2].Power.CMD</string_identifier>
              </node_id>
              <attribute_id>VALUE</attribute_id>
            </node_attribute>
        </opcua_output>
      </publication>
    </opcua_to_dds_bridge>
  </ddsopcua_service>
</dds>
